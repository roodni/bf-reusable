let fix = fun f ->
  let g = fun x -> f (fun y -> x x y) in
  g g

let gen_puts = fun l -> [
  $var { c: cell; } in
  *fix
    (fun loop prev l ->
      match l with
      | nil -> []
      | hd :: tl -> [
          + c (hd - prev)
          . c
          *loop hd tl
        ])
    0 l
]

main {} [
  *gen_puts "hello world\n"
]